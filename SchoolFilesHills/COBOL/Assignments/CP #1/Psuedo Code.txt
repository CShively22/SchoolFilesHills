CP #1

Carson Shively
Cobol 1
12/01/2021

Variable Declaration
INT     I-PAINT-YY, I-PAINT-MM, I-PAINT-DD, I-WALL-SQFT, I-DOOR-SQFT, C-PGCTR = 0, C-JOB-CTR = 0, C-TOTAL-SQFT, 
            I-MONTH, I-DAY, I-YEAR,
FLOAT   I-PRICE-PER-GAL,C-GAL-NEEDED, C-PAINT-COST, C-LABOR-COST, C-TOTAL-COST, C-GT-GAL-NEEDED, 
            C-GT-PAINT-COST, C-GT-LABOR-COST, C-GT-TOTAL-COST
*
STRING  I-EST-NUM, O-EST-NUM, O-PAINT-YY, O-PAINT-MM, O-PAINT-DD, O-WALL-SQFT, O-DOOR-SQFT, O-TOTAL-SQFT, O-GAL-NEEDED,
            O-PRICE-PER-GAL, O-PAINT-COST, O-LABOR-COST, O-TOTAL-COST, O-JOB-CTR, O-GT-GAL-NEEDED, O-GT-PAINT-COST,
            O-GT-LABOR-COST, O-GT-TOTAL-COST

0000-Main
    CALL INIT
    DO WHILE EOF != TRUE
        CALL DETAIL
    CALL CLOSING


1000-INIT
    GET SYSTEM DATE
    MOVE SYSTEM DATE TO O-DATE 

    OPEN INPUT FILE
    OPEN OUTPUT FILE

    CALL READ
    CALL HEADINGS
    

2000-DETAIL
    DO CALCS
    DO OUTUPUT
    DO READ


2100-CALCS
    C-TOTAL-SQFT = I-WALL-SQFT - C-DOOR-SQFT

    C-GAL-NEEDED = C-WALL-SPACE / 115
    
    C-PAINT-COST = C-GAL-NEEDED * I-PRICE-PER-GAL
    C-LABOR-COST = (C-GAL-NEEDED * 3) * 23.55
    C-TOTAL-COST = C-PAINT-COST + C-LABOR-COST

    C-JOB-CTR += 1

    C-GT-PAINT-COST += C-PAINT-COST
    C-GT-LABOR-COST += C-LABOR-COST
    C-GT-TOTAL-COST += C-TOTAL-COST

    C-GT-GAL-NEEDED += C-GAL-NEEDED


2200-OUTPUT
    MOVE I-EST-NUM TO O-EST-NUM
    MOVE I-PAINT-MM TO O-PAINT-MM
    MOVE I-PAINT-MM TO O-PAINT-DD
    MOVE I-PAINT-MM TO O-PAINT-YY
    MOVE I-WALL-SQFT TO O-WALL-SQFT
    MOVE I-DOOR-SQFT TO O-DOOR-SQFT
    MOVE I-PRICE-PER-GAL TO O-PRICE-PER-GAL
    
    MOVE C-TOTAL-SQFT TO O-TOTAL-SQFT
    MOVE C-GAL-NEEDED TO O-GAL-NEEDED
    MOVE C-PAINT-COST TO O-PAINT-COST
    MOVE C-LABOR-COST TO O-PAINT-COST
    MOVE C-TOTAL-COST TO O-TOTAL-COST

    PRINT DETAIL LINE 
        AFTER ADVANCING 1 LINES

    IF EOP
        CALL HEADINGS
        

3000-CLOSING
    CALL GRAND-TOTALS
    CLOSE INPUT FILE
    CLOSE OUTPUT FILE


3100-GRAND-TOTALS
    MOVE C-JOB-CTR TO O-JOB-CTR
    MOVE C-GT-GAL-NEEDED TO O-GT-GAL-NEEDED
    MOVE C-GT-PAINT-COST TO O-GT-PAINT-COST
    MOVE C-GT-LABOR-COST TO O-GT-LABOR-COST
    MOVE C-GT-TOTAL-COST TO O-GT-TOTAL-COST

    PRINT GRAND TOTAL LINE
        AFTER ADVANCING 3 LINES


9000 - READ
    READ INPUT FILE
	IF EOF
	   MORE-RECS = 'NO'.


9100 - HEADINGS
    ADD 1 TO C-PGCTR
    PRINT TITLE-LINE
    PRINT H1-LINE
    PRINT H2-LINE
